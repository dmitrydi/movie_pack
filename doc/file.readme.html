<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: readme
  
    &mdash; Documentation by YARD 0.9.5
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "readme";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: readme</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="file_list.html"></iframe>

      <div id="content"><div id='filecontents'>
<h1 id="label-MoviePack">MoviePack</h1>

<h2 id="label-DESCRIPTION">DESCRIPTION</h2>

<p>The Movie Pack library consists of two main parts:</p>
<ul><li>
<p>Two cinema classes: Netflix and Theatre. Netflix shows movies with
desirable filters, Theatre is used for  scheduling cinema and selling
tickets.</p>
</li><li>
<p>WebFetcher module which has the following features:</p>
</li><li>
<p>fetching data of IMDB TOP-250 chart movies</p>
</li><li>
<p>formatting movies data to .html - file</p>
</li></ul>

<h2 id="label-INSTALL">INSTALL</h2>

<p>gem install movie_pack</p>

<h2 id="label-USE">USE</h2>

<h3 id="label-Theatre+class">Theatre class</h3>

<p>To use <code>Theatre</code> class it is nessessary to create an instance. 
“`ruby  require &#39;movie_pack&#39;</p>

<pre class="code ruby"><code class="ruby"># initialize in ruby module
  theatre = Theatre.new( [[movie_array]], [&amp;block] )

# default initialize for use
  theatre = Theatre.read =&gt; #initialized from &#39;data\movie_pack\movies.txt&#39; with default parameters</code></pre>

<p>“<code>  where[movie_array]</code><code>is an array of instances
of</code>Movie` class which is internal utility class of the lib. When
omitted initialization is made from &#39;datamovie_packmovies.txt&#39;
file.</p>

<p>The instance created has its cash desk for money storage and safe
encashment operations.</p>

<p>User can specify the schedule of the theatre using proc
<code>&amp;block</code>:</p>

<p>“`ruby  theatre =  Theatre.new do  hall :red, title: &#39;Red Hall&#39;,
places: 100  hall :blue, title: &#39;Blue Hall&#39;, places: 50</p>

<pre class="code ruby"><code class="ruby">    period &#39;09:00&#39;..&#39;11:00&#39; do
      description &#39;Morning&#39;
      filters genre: &#39;Comedy&#39;, year: 1900..1980
      price 20
      hall :red, :blue
    end
  end</code></pre>

<p>“<code>   This defines a</code>theatre<code>instance with two
halls</code>:red, :blue<code>and one
period</code>&#39;09:00&#39;..&#39;11:00&#39;<code>.
</code>#description<code>method sets a name of the period
</code>#filters<code>method sets filters for movies that may be shown
during the period </code>#price<code>method sets the price for tickets for
the period </code>#hall<code>method specifies halls that work for the
period. Halls used in</code>#periods<code>must be defined first
with</code>#hall` method, as shown in the example.</p>

<p>Theatre class provides some useful methods for work with the theatre.</p>

<p><code>#check_schedule</code>  Checks whether a <code>theatre</code> defined
with a block has any crissings in schedule</p>

<p><code>#time_for(movie_title)</code>  Returnes time of showing movie
<em>movie_title</em></p>

<p><code>#buy_ticket(time)</code>  Sells a ticket for a movie in accordance
with the period that includes <em>time</em>. If there is no period that may
include <em>time</em>, retunes <code>ScheduleError</code>. Returnes the
name of the movie, hall name and puts amount of money equal to ticket price
to the cash desk.</p>

<p><code>#cash</code>  Returnes the amount of money in the cash desk.</p>

<p><code>#take(who)</code>  Empties the cash desk if <code>who ==
&#39;Bank&#39;</code>. Otherwise, returnes <code>EncashmentError</code> and
calls the police.</p>

<h3 id="label-Netflix+class">Netflix class</h3>

<p>Netflix class can be used for creation of online cinema theatre. It
provides methods for filtering movies for showing in accordance with
user&#39;s preferences and working with built-in cash desk.</p>

<p>Initialization  “`ruby  #initialize with array of movies  netflix = <a
href="movie_array">Netflix.new([</a>])</p>

<p>#default initialize from .txt-file  netflix = Netflix.read  “<code>  In the
latter case</code>netflix` is initialized from file
&#39;datamovie_packmovies.txt&#39; (see Theatre class initialization).</p>

<p>`#show(filter = {}, &amp;block)  Shows a random movie according to filters
specified by <em>filter</em> or <em>&amp;block</em> parameters.</p>

<p><code>filter</code> can be defined in multiple ways:</p>

<p>“`ruby  #plain filter  netflix.show(period: &#39;ancient&#39;, genre:
&#39;Comedy&#39;) #=&gt; shows ancient movie of comedy genre</p>

<p>#block filter  netflix.show { |m| m.period == &#39;ancient&#39; } #=&gt;
shows ancient movie</p>

<p>#pre-defined filter  netflix.define_filter(:new_sci_fi) { |m|
m.genre.include?(&#39;Sci-Fi&#39;) &amp;&amp; m.period == &#39;new&#39; } 
netflix.show(new_sci_fi: true) #=&gt; shows new movie of sci-fi genre  “`</p>

<p><code>#define_filter</code></p>

<p><code>#define_filter</code> method can be used for defining filters for
movies to show. One example is shown above. This method also allows user to
define new filters from previously defined filters:</p>

<p>“`ruby  netflix.define_filter(:new_sci_fi) { |year, movie| movie.year &gt;
year &amp;&amp; movie.genre.include?(&#39;Sci-Fi&#39;) } 
netflix.define_filter(:newest_sci_fi, from: :new_sci_fi_2, arg: 2010)</p>

<p>netflix.show(new_sci_fi: 2005) #=&gt; shows movie later than 2005 year of
production  netflix.show(newest_sci_fi: true) #=&gt; shows movie later than
2010 year of production  “`</p>

<p><code>#pay</code></p>

<p>Before using <code>#show</code> method some amount of money should be paid
first:</p>

<p><code>ruby    netflix = Netflix.red    netflix.show #=&gt; &quot;Error: you
don&#39;t have enough money&quot;    netflix.pay(10)    netflix.cash #=&gt;
10    netflix.show #=&gt; &#39;Now showing: ....&#39;    netflix.money
#=&gt; 10 - movie.price </code>  method
<code>#price_for(movie_title)</code> allows user to know how much a certain
film costs:</p>

<p><code>ruby  netflix.price_for(&#39;The Terminator&#39;) #=&gt; price of the
movie </code></p>

<p><code>#by_genre</code>, <code>#by_country</code>  Netflix allows to output
an array of movies filtered by <em>genre</em> and <em>country</em>
attributes:</p>

<p><code>ruby  netflix.by_genre.comedy #=&gt; an array of comedy movies 
netflix.by_country.usa #=&gt; an array of movies produced in the USA
</code></p>

<h3 id="label-MoviePack-3A-3AWebFetcher+module">MoviePack::WebFetcher module</h3>

<p>Module designed for fetching data for movies in TOP-250 IMDB rating. 
Includes several modules for fetching different types of movie data.</p>

<h4 id="label-IMDBBudgets+module">IMDBBudgets module</h4>

<p>Module designed for fetching data from IMDB TOP-250 movie chart.</p>

<p><code>#self.fetch(top_chart_url)</code> Fetching budgets of movies listed
in <a href="http://www.imdb.com/chart/top?ref_=nv_mv_250_6">IMDB Top-250
chart</a>. Returnes an array of data. Top-250 chart web-address is stored
in <code>MoviePack::WebFetcher::TOP_250_URL</code> Example use: <code>ruby
url = MoviePack::WebFetcher::TOP_250_URL
MoviePack::WebFetcher::IMDBBudgets.fetch(url) #=&gt; [ {:imdb_id =&gt; ...,
:name =&gt; ..., :budget =&gt; ...}, ...] </code></p>

<p><code>#self.to_file(top_chart_url: TOP_250_URL, file_name:
DEFAULT_BUDGETS_FILE) Fetching budgets of movies listed in
<em>top_chart_url</em> and saving to yaml-file <em>file_name</em> . default
file path</code>movie_packdatamovie_packweb_fetcherbudgets.yml` Example
use: <code>ruby MoviePack::WebFetcher::IMDBBudgets.to_file #=&gt;
movie_pack\data\movie_pack\web_fetcher\budgets.yml </code></p>

<h4 id="label-TMDBData+module">TMDBData module</h4>

<p>Module designed for fetching data for movies in IMDB TOP-250 movie chart
from <a href="https://www.themoviedb.org/">TMDB</a> using its free API.
Before using this module API key should be received and placed to
<code>movie_pack\config\web_fetcher\tmdb.yml</code> file.</p>

<p><code>#self.make_id_list(top_chart_url, file_name = DEFAULT_ID_FILE)</code></p>

<p>Method for fetching TMDB ids and movie names from <em>themoviedb.org</em>
corresponding to movies listed in IMDB Top-250 chart and saving to file
<em>file_name</em> . Default file path is
<code>movie_pack\data\movie_pack\web_fetcher\id_list.yml</code> Example
use: <code>ruby url = MoviePack::WebFetcher::TOP_250_URL
MoviePack::WebFetcher::TMDBData.set_api_key
MoviePack::WebFetcher::TMDBData.make_id_list(url) #=&gt;
movie_pack\data\movie_pack\web_fetcher\id_list.yml </code></p>

<h5 id="label-TMDBFetcher+class">TMDBFetcher class</h5>

<p>Class designd for fetching posters and alternative titles for movies from
top-250 chart.</p>

<p><code>#initialize(id_file: DEFAULT_ID_FILE, posters_path: POSTERS_PATH,
alt_titles_file: ALT_TITLES_FILE, budgets_file:
DEFAULT_BUDGETS_FILE)</code></p>

<p>Creates an instance of TMDBFetcher. Default parameters are as follows:  -
<em>DEFAULT_ID_FILE</em> = movie_packdatamovie_packweb_fetcherid_list.yml 
- <em>POSTERS_PATH</em> = movie_packdatamovie_packweb_fetcherposters\  -
<em>ALT_TITLES_FILE</em> =
movie_packdatamovie_packweb_fetcheralt_titles.yml  -
<em>DEFAULT_BUDGETS_FILE</em> =
movie_packdatamovie_packweb_fetcherbudgets.yml</p>

<p>Does not require pre-setting API key with <code>TMDBData.set_api_key</code>
as setting is performed automatically with initialization.</p>

<p><code>#ids_from_file(id_file)</code> Parses <em>id_file</em> created with
<code>TMDBData.make_id_list</code> to get TMDB ids. Returnes an array of
ids. <code>ruby id_file = MoviePack::WebFetcher::DEFAULT_ID_FILE
MoviePack::WebFetcher::TMDBData::TMDBFetcher.new.ids_from_file(id_file)
#=&gt; ary </code></p>

<p><code>#fetch_posters_to_dir</code> Fetches posters to dir specified in
<em>posters_path</em> parameter: <code>ruby
MoviePack::WebFetcher::TMDBData::TMDBFetcher.new.fetch_posters_to_dir
</code></p>

<p><code>#fetch_alt_titles_to_file</code> Fetches alternative titles specified
in <em>alt_titles_file</em> parameter: <code>ruby
MoviePack::WebFetcher::TMDBData::TMDBFetcher.new.fetch_alt_titles_to_file
</code></p>

<h4 id="label-HTMLBuilder+module">HTMLBuilder module</h4>

<p>Designed for formatting data of movie titles, posters, budgets and
alternative titles into html-file.</p>

<p><code>self.build(       top_chart_url: TOP_250_URL,       output_html:
DEFAULT_HTML_FILE,       id_file: DEFAULT_ID_FILE,       budgets_file:
DEFAULT_BUDGETS_FILE,       alt_titles_file: ALT_TITLES_FILE,      
posters_path: POSTERS_PATH     )</code></p>

<p>Makes an html-file from data files. Data is read from <em>id_file</em>,
<em>budgets_file</em>, <em>alt_titles_file</em>, posters are taken from
<em>posters_path</em>. Output HTML-file is <em>output_html</em>. If any
data files are missing, <code>#build</code> automatically creates them. API
key file <code>tmdb.yml</code> and HAML template
<code>haml_template.haml</code> must be in dirs
<code>movie_pack\config\web_fetcher&lt;/code&gt; and
&lt;code&gt;movie_pack\data\movie_pack\web_fetcher&lt;/code&gt;
respectively. To view API key and HAML template paths check
&lt;code&gt;MoviePack::WebFetcher::API_KEY_FILE</code> and
<code>MoviePack::WebFetcher::DEFAULT_HAML_FILE</code> constants.</p>

<pre class="code ruby"><code class="ruby"><span class='const'>MoviePack</span><span class='op'>::</span><span class='const'>WebFetcher</span><span class='op'>::</span><span class='const'>HTMLBuilder</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span> <span class='comment'>#=&gt; an HTML-file movie_data.html
</span></code></pre>
</div></div>

      <div id="footer">
  Generated on Tue Sep  6 18:53:15 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.5 (ruby-2.3.0).
</div>

    </div>
  </body>
</html>